"use strict";(self.webpackChunkbudget_calculator_app=self.webpackChunkbudget_calculator_app||[]).push([[744],{2744(e,t,a){a.d(t,{autoSyncOnLoad:()=>n,setupDailySync:()=>r,syncOnDataChange:()=>c});const o={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_BACKEND_URL||"http://localhost:8000",s=async e=>{try{const s=await fetch("".concat(o,"/api/google-sheets/import"),{method:"POST",headers:{"Content-Type":"application/json"}});if(!s.ok)throw new Error("Failed to import from Google Sheets");const n=await s.json();if("error"===n.status)return console.warn("Google Sheets sync error:",n.message),{success:!1,message:n.message};if("success"===n.status&&n.data){if(n.data.transactions&&Array.isArray(n.data.transactions))for(const o of n.data.transactions)try{var t;if(!await e.transactions.get(o.ID))await e.transactions.add({id:o.ID,type:(null===(t=o.Type)||void 0===t?void 0:t.toLowerCase())||"expense",category:o.Category||"",amount:parseFloat(o.Amount)||0,description:o.Description||"",date:o.Date||o["Created At"]||(new Date).toISOString(),createdAt:o["Created At"]||(new Date).toISOString(),files:[]})}catch(a){console.error("Error importing transaction:",a)}if(n.data.expenses&&Array.isArray(n.data.expenses))for(const t of n.data.expenses)try{await e.expenses.get(t.ID)||await e.expenses.add({id:t.ID,category:t.Category||"",subcategory:t.Subcategory||"",amount:parseFloat(t.Amount)||0,description:t.Description||"",date:t.Date||t["Created At"]||(new Date).toISOString(),createdAt:t["Created At"]||(new Date).toISOString(),files:[]})}catch(a){console.error("Error importing expense:",a)}if(n.data.savings&&Array.isArray(n.data.savings))for(const t of n.data.savings)try{await e.savings.get(t.ID)||await e.savings.add({id:t.ID,accountType:t["Account Type"]||t.accountType||"",amount:parseFloat(t.Amount)||0,date:t.Date||t["Deposit Date"]||(new Date).toISOString(),maturityDate:t["Maturity Date"]||t.maturityDate||"",interestRate:parseFloat(t["Interest Rate"]||t.interestRate||0),description:t.Description||"",createdAt:t["Created At"]||(new Date).toISOString(),files:[]})}catch(a){console.error("Error importing saving:",a)}return{success:!0,message:"Data synced from Google Sheets"}}return{success:!1,message:"No data to import"}}catch(a){return console.error("Error syncing from Google Sheets:",a),{success:!1,message:a.message}}},n=async e=>{try{console.log("\ud83d\udd04 Starting auto-sync from Google Sheets...");const t=await s(e);return t.success?(console.log("\u2705 Auto-sync completed:",t.message),window.dispatchEvent(new Event("dataChanged")),!0):(console.warn("\u26a0\ufe0f Auto-sync warning:",t.message),!1)}catch(t){return console.error("\u274c Auto-sync error:",t),!1}},r=e=>{const t="lastGoogleSheetsSync",a=async()=>{if((()=>{const e=localStorage.getItem(t);if(!e)return!0;const a=parseInt(e,10);return Date.now()-a>=864e5})()){console.log("\ud83d\udcc5 Performing daily sync...");(await s(e)).success&&(localStorage.setItem(t,Date.now().toString()),window.dispatchEvent(new Event("dataChanged")))}};a();const o=setInterval(a,36e5);return()=>clearInterval(o)},c=async()=>{try{window.syncTimeout&&clearTimeout(window.syncTimeout),window.syncTimeout=setTimeout(async()=>{console.log("\ud83d\udce4 Syncing changes to Google Sheets...");const e=await(async()=>{try{const e=await fetch("".concat(o,"/api/google-sheets/sync"),{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error("Failed to sync to Google Sheets");return await e.json()}catch(e){return console.error("Error syncing to Google Sheets:",e),{status:"error",message:e.message}}})();"success"===e.status?console.log("\u2705 Changes synced to Google Sheets"):console.warn("\u26a0\ufe0f Sync warning:",e.message)},2e3)}catch(e){console.error("Error in sync on data change:",e)}}}}]);
//# sourceMappingURL=744.b9bc115d.chunk.js.map