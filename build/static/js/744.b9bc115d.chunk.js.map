{"version":3,"file":"static/js/744.b9bc115d.chunk.js","mappings":"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","sources":["utils/googleSheetsSync.js"],"sourcesContent":["/**\n * Google Sheets Sync Utility\n * Handles bidirectional sync between local IndexedDB and Google Sheets\n * \n * Google Sheet ID: 1Dp4UGkT8h-PHnEXDPbGqnnDxsvhP6zO_UvxXH4xXLu0\n * Sheet URL: https://docs.google.com/spreadsheets/d/1Dp4UGkT8h-PHnEXDPbGqnnDxsvhP6zO_UvxXH4xXLu0/edit?usp=sharing\n */\n\nconst BACKEND_URL = process.env.REACT_APP_BACKEND_URL || 'http://localhost:8000';\n// Google Sheet ID is configured in backend/google_sheets.py\n\n/**\n * Sync all data from Google Sheets to local IndexedDB\n */\nexport const syncFromGoogleSheets = async (db) => {\n  try {\n    const response = await fetch(`${BACKEND_URL}/api/google-sheets/import`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to import from Google Sheets');\n    }\n\n    const result = await response.json();\n    \n    if (result.status === 'error') {\n      console.warn('Google Sheets sync error:', result.message);\n      return { success: false, message: result.message };\n    }\n\n    if (result.status === 'success' && result.data) {\n      // Import transactions\n      if (result.data.transactions && Array.isArray(result.data.transactions)) {\n        for (const transaction of result.data.transactions) {\n          try {\n            // Check if transaction already exists\n            const existing = await db.transactions.get(transaction.ID);\n            if (!existing) {\n              await db.transactions.add({\n                id: transaction.ID,\n                type: transaction.Type?.toLowerCase() || 'expense',\n                category: transaction.Category || '',\n                amount: parseFloat(transaction.Amount) || 0,\n                description: transaction.Description || '',\n                date: transaction.Date || transaction['Created At'] || new Date().toISOString(),\n                createdAt: transaction['Created At'] || new Date().toISOString(),\n                files: []\n              });\n            }\n          } catch (error) {\n            console.error('Error importing transaction:', error);\n          }\n        }\n      }\n\n      // Import expenses\n      if (result.data.expenses && Array.isArray(result.data.expenses)) {\n        for (const expense of result.data.expenses) {\n          try {\n            const existing = await db.expenses.get(expense.ID);\n            if (!existing) {\n              await db.expenses.add({\n                id: expense.ID,\n                category: expense.Category || '',\n                subcategory: expense.Subcategory || '',\n                amount: parseFloat(expense.Amount) || 0,\n                description: expense.Description || '',\n                date: expense.Date || expense['Created At'] || new Date().toISOString(),\n                createdAt: expense['Created At'] || new Date().toISOString(),\n                files: []\n              });\n            }\n          } catch (error) {\n            console.error('Error importing expense:', error);\n          }\n        }\n      }\n\n      // Import savings\n      if (result.data.savings && Array.isArray(result.data.savings)) {\n        for (const saving of result.data.savings) {\n          try {\n            const existing = await db.savings.get(saving.ID);\n            if (!existing) {\n              await db.savings.add({\n                id: saving.ID,\n                accountType: saving['Account Type'] || saving.accountType || '',\n                amount: parseFloat(saving.Amount) || 0,\n                date: saving.Date || saving['Deposit Date'] || new Date().toISOString(),\n                maturityDate: saving['Maturity Date'] || saving.maturityDate || '',\n                interestRate: parseFloat(saving['Interest Rate'] || saving.interestRate || 0),\n                description: saving.Description || '',\n                createdAt: saving['Created At'] || new Date().toISOString(),\n                files: []\n              });\n            }\n          } catch (error) {\n            console.error('Error importing saving:', error);\n          }\n        }\n      }\n\n      return { success: true, message: 'Data synced from Google Sheets' };\n    }\n\n    return { success: false, message: 'No data to import' };\n  } catch (error) {\n    console.error('Error syncing from Google Sheets:', error);\n    return { success: false, message: error.message };\n  }\n};\n\n/**\n * Sync all local data to Google Sheets\n */\nexport const syncToGoogleSheets = async () => {\n  try {\n    const response = await fetch(`${BACKEND_URL}/api/google-sheets/sync`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to sync to Google Sheets');\n    }\n\n    const result = await response.json();\n    return result;\n  } catch (error) {\n    console.error('Error syncing to Google Sheets:', error);\n    return { status: 'error', message: error.message };\n  }\n};\n\n/**\n * Auto-sync on app load - fetch latest data from Google Sheets\n */\nexport const autoSyncOnLoad = async (db) => {\n  try {\n    console.log('üîÑ Starting auto-sync from Google Sheets...');\n    const result = await syncFromGoogleSheets(db);\n    \n    if (result.success) {\n      console.log('‚úÖ Auto-sync completed:', result.message);\n      // Trigger data change event to refresh UI\n      window.dispatchEvent(new Event('dataChanged'));\n      return true;\n    } else {\n      console.warn('‚ö†Ô∏è Auto-sync warning:', result.message);\n      return false;\n    }\n  } catch (error) {\n    console.error('‚ùå Auto-sync error:', error);\n    return false;\n  }\n};\n\n/**\n * Set up daily sync - syncs once per day\n */\nexport const setupDailySync = (db) => {\n  const LAST_SYNC_KEY = 'lastGoogleSheetsSync';\n  const ONE_DAY_MS = 24 * 60 * 60 * 1000;\n\n  const shouldSync = () => {\n    const lastSync = localStorage.getItem(LAST_SYNC_KEY);\n    if (!lastSync) return true;\n    \n    const lastSyncTime = parseInt(lastSync, 10);\n    const now = Date.now();\n    return (now - lastSyncTime) >= ONE_DAY_MS;\n  };\n\n  const performDailySync = async () => {\n    if (shouldSync()) {\n      console.log('üìÖ Performing daily sync...');\n      const result = await syncFromGoogleSheets(db);\n      if (result.success) {\n        localStorage.setItem(LAST_SYNC_KEY, Date.now().toString());\n        window.dispatchEvent(new Event('dataChanged'));\n      }\n    }\n  };\n\n  // Sync immediately if needed\n  performDailySync();\n\n  // Set up interval to check daily (check every hour)\n  const intervalId = setInterval(performDailySync, 60 * 60 * 1000);\n\n  return () => clearInterval(intervalId);\n};\n\n/**\n * Sync when data changes - push to Google Sheets\n */\nexport const syncOnDataChange = async () => {\n  try {\n    // Small delay to batch multiple changes\n    if (window.syncTimeout) {\n      clearTimeout(window.syncTimeout);\n    }\n\n    window.syncTimeout = setTimeout(async () => {\n      console.log('üì§ Syncing changes to Google Sheets...');\n      const result = await syncToGoogleSheets();\n      if (result.status === 'success') {\n        console.log('‚úÖ Changes synced to Google Sheets');\n      } else {\n        console.warn('‚ö†Ô∏è Sync warning:', result.message);\n      }\n    }, 2000); // Wait 2 seconds before syncing to batch changes\n  } catch (error) {\n    console.error('Error in sync on data change:', error);\n  }\n};\n\n"],"names":["BACKEND_URL","process","REACT_APP_BACKEND_URL","syncFromGoogleSheets","async","response","fetch","concat","method","headers","ok","Error","result","json","status","console","warn","message","success","data","transactions","Array","isArray","transaction","_transaction$Type","db","get","ID","add","id","type","Type","toLowerCase","category","Category","amount","parseFloat","Amount","description","Description","date","Date","toISOString","createdAt","files","error","expenses","expense","subcategory","Subcategory","savings","saving","accountType","maturityDate","interestRate","autoSyncOnLoad","log","window","dispatchEvent","Event","setupDailySync","LAST_SYNC_KEY","performDailySync","shouldSync","lastSync","localStorage","getItem","lastSyncTime","parseInt","now","setItem","toString","intervalId","setInterval","clearInterval","syncOnDataChange","syncTimeout","clearTimeout","setTimeout","syncToGoogleSheets"],"ignoreList":[],"sourceRoot":""}